# 生鲜配送系统 API 接口文档

## 目录
- [1. 小程序端接口](#1-小程序端接口)
- [2. 管理端接口](#2-管理端接口)
- [3. 配送端接口](#3-配送端接口)
- [4. 通用响应格式](#4-通用响应格式)
- [5. 错误码说明](#5-错误码说明)

---

## 1. 小程序端接口

### 1.1 商品相关接口

#### 1.1.1 获取商品列表
- **接口地址**: `GET /miniapp/product/list`
- **接口描述**: 分页获取商品列表
- **请求参数**:
  | 参数名 | 类型 | 必填 | 默认值 | 说明 |
  |--------|------|------|--------|------|
  | pageNum | Integer | 否 | 1 | 页码 |
  | pageSize | Integer | 否 | 10 | 每页数量 |
  | categoryId | Long | 否 | - | 分类ID |

- **响应示例**:
```json
{
  "code": 200,
  "message": "操作成功",
  "data": {
    "total": 100,
    "records": [
      {
        "id": 1,
        "categoryId": 1,
        "name": "新鲜苹果",
        "description": "优质红富士苹果",
        "price": 12.50,
        "stock": 100,
        "image": "https://example.com/apple.jpg",
        "status": 1,
        "createTime": "2024-01-01T10:00:00",
        "updateTime": "2024-01-01T10:00:00"
      }
    ]
  }
}
```

#### 1.1.2 获取商品详情
- **接口地址**: `GET /miniapp/product/detail/{id}`
- **接口描述**: 根据商品ID获取商品详情
- **路径参数**:
  | 参数名 | 类型 | 必填 | 说明 |
  |--------|------|------|------|
  | id | Long | 是 | 商品ID |

- **响应示例**:
```json
{
  "code": 200,
  "message": "操作成功",
  "data": {
    "id": 1,
    "categoryId": 1,
    "name": "新鲜苹果",
    "description": "优质红富士苹果，产地山东烟台",
    "price": 12.50,
    "stock": 100,
    "image": "https://example.com/apple.jpg",
    "status": 1,
    "createTime": "2024-01-01T10:00:00",
    "updateTime": "2024-01-01T10:00:00"
  }
}
```

### 1.2 分类相关接口

#### 1.2.1 获取分类列表
- **接口地址**: `GET /miniapp/category/list`
- **接口描述**: 获取所有商品分类
- **请求参数**: 无

- **响应示例**:
```json
{
  "code": 200,
  "message": "操作成功",
  "data": [
    {
      "id": 1,
      "name": "水果",
      "description": "新鲜水果",
      "image": "https://example.com/fruit.jpg",
      "sort": 1,
      "status": 1,
      "createTime": "2024-01-01T10:00:00",
      "updateTime": "2024-01-01T10:00:00"
    }
  ]
}
```

#### 1.2.2 获取分类详情
- **接口地址**: `GET /miniapp/category/detail/{id}`
- **接口描述**: 根据分类ID获取分类详情
- **路径参数**:
  | 参数名 | 类型 | 必填 | 说明 |
  |--------|------|------|------|
  | id | Long | 是 | 分类ID |

### 1.3 购物车相关接口

#### 1.3.1 获取购物车列表
- **接口地址**: `GET /miniapp/cart/list`
- **接口描述**: 获取用户购物车商品列表
- **请求参数**:
  | 参数名 | 类型 | 必填 | 说明 |
  |--------|------|------|------|
  | userId | Long | 是 | 用户ID |

- **响应示例**:
```json
{
  "code": 200,
  "message": "操作成功",
  "data": [
    {
      "id": 1,
      "userId": 1,
      "productId": 1,
      "productName": "新鲜苹果",
      "productImage": "https://example.com/apple.jpg",
      "price": 12.50,
      "quantity": 2,
      "createTime": "2024-01-01T10:00:00",
      "updateTime": "2024-01-01T10:00:00"
    }
  ]
}
```

#### 1.3.2 添加商品到购物车
- **接口地址**: `POST /miniapp/cart/add`
- **接口描述**: 添加商品到购物车
- **请求体**:
```json
{
  "userId": 1,
  "productId": 1,
  "quantity": 2
}
```

#### 1.3.3 更新购物车商品数量
- **接口地址**: `PUT /miniapp/cart/update`
- **接口描述**: 更新购物车中商品的数量
- **请求体**:
```json
{
  "id": 1,
  "quantity": 3
}
```

#### 1.3.4 删除购物车商品
- **接口地址**: `DELETE /miniapp/cart/delete/{id}`
- **接口描述**: 删除购物车中的商品
- **路径参数**:
  | 参数名 | 类型 | 必填 | 说明 |
  |--------|------|------|------|
  | id | Long | 是 | 购物车项ID |

#### 1.3.5 清空购物车
- **接口地址**: `DELETE /miniapp/cart/clear`
- **接口描述**: 清空用户购物车
- **请求参数**:
  | 参数名 | 类型 | 必填 | 说明 |
  |--------|------|------|------|
  | userId | Long | 是 | 用户ID |

### 1.4 订单相关接口

#### 1.4.1 获取订单列表
- **接口地址**: `GET /miniapp/order/list`
- **接口描述**: 分页获取用户订单列表
- **请求参数**:
  | 参数名 | 类型 | 必填 | 默认值 | 说明 |
  |--------|------|------|--------|------|
  | pageNum | Integer | 否 | 1 | 页码 |
  | pageSize | Integer | 否 | 10 | 每页数量 |
  | userId | Long | 是 | - | 用户ID |
  | status | Integer | 否 | - | 订单状态 |

- **响应示例**:
```json
{
  "code": 200,
  "message": "操作成功",
  "data": {
    "total": 50,
    "records": [
      {
        "id": 1,
        "orderNo": "ORD20240101001",
        "userId": 1,
        "totalAmount": 25.00,
        "status": 1,
        "statusText": "待支付",
        "addressInfo": "北京市朝阳区xxx",
        "createTime": "2024-01-01T10:00:00",
        "items": [
          {
            "id": 1,
            "productId": 1,
            "productName": "新鲜苹果",
            "productImage": "https://example.com/apple.jpg",
            "price": 12.50,
            "quantity": 2
          }
        ]
      }
    ]
  }
}
```

#### 1.4.2 获取订单详情
- **接口地址**: `GET /miniapp/order/detail/{id}`
- **接口描述**: 根据订单ID获取订单详情
- **路径参数**:
  | 参数名 | 类型 | 必填 | 说明 |
  |--------|------|------|------|
  | id | Long | 是 | 订单ID |

#### 1.4.3 创建订单
- **接口地址**: `POST /miniapp/order/create`
- **接口描述**: 创建新订单
- **请求体**:
```json
{
  "userId": 1,
  "addressId": 1,
  "items": [
    {
      "productId": 1,
      "quantity": 2
    }
  ]
}
```

#### 1.4.4 准备支付
- **接口地址**: `POST /miniapp/order/prepare-pay/{orderId}`
- **接口描述**: 准备订单支付
- **路径参数**:
  | 参数名 | 类型 | 必填 | 说明 |
  |--------|------|------|------|
  | orderId | Long | 是 | 订单ID |

#### 1.4.5 支付成功回调
- **接口地址**: `POST /miniapp/order/paid/{orderId}`
- **接口描述**: 支付成功后更新订单状态
- **路径参数**:
  | 参数名 | 类型 | 必填 | 说明 |
  |--------|------|------|------|
  | orderId | Long | 是 | 订单ID |

#### 1.4.6 确认收货
- **接口地址**: `POST /miniapp/order/confirm/{orderId}`
- **接口描述**: 确认收货
- **路径参数**:
  | 参数名 | 类型 | 必填 | 说明 |
  |--------|------|------|------|
  | orderId | Long | 是 | 订单ID |

### 1.5 地址相关接口

#### 1.5.1 获取地址列表
- **接口地址**: `GET /miniapp/address/list`
- **接口描述**: 获取用户收货地址列表
- **请求参数**:
  | 参数名 | 类型 | 必填 | 说明 |
  |--------|------|------|------|
  | userId | Long | 是 | 用户ID |

- **响应示例**:
```json
{
  "code": 200,
  "message": "操作成功",
  "data": [
    {
      "id": 1,
      "userId": 1,
      "receiverName": "张三",
      "receiverPhone": "13800138000",
      "province": "北京市",
      "city": "北京市",
      "district": "朝阳区",
      "detail": "xxx街道xxx号",
      "isDefault": true,
      "createTime": "2024-01-01T10:00:00",
      "updateTime": "2024-01-01T10:00:00"
    }
  ]
}
```

#### 1.5.2 获取地址详情
- **接口地址**: `GET /miniapp/address/detail/{id}`
- **接口描述**: 根据地址ID获取地址详情
- **路径参数**:
  | 参数名 | 类型 | 必填 | 说明 |
  |--------|------|------|------|
  | id | Long | 是 | 地址ID |

#### 1.5.3 添加收货地址
- **接口地址**: `POST /miniapp/address/add`
- **接口描述**: 添加新的收货地址
- **请求体**:
```json
{
  "userId": 1,
  "receiverName": "张三",
  "receiverPhone": "13800138000",
  "province": "北京市",
  "city": "北京市",
  "district": "朝阳区",
  "detail": "xxx街道xxx号",
  "isDefault": false
}
```

#### 1.5.4 更新收货地址
- **接口地址**: `PUT /miniapp/address/update`
- **接口描述**: 更新收货地址信息
- **请求体**:
```json
{
  "id": 1,
  "receiverName": "李四",
  "receiverPhone": "13800138001",
  "province": "上海市",
  "city": "上海市",
  "district": "浦东新区",
  "detail": "xxx路xxx号",
  "isDefault": true
}
```

#### 1.5.5 删除收货地址
- **接口地址**: `DELETE /miniapp/address/delete/{id}`
- **接口描述**: 删除收货地址
- **路径参数**:
  | 参数名 | 类型 | 必填 | 说明 |
  |--------|------|------|------|
  | id | Long | 是 | 地址ID |

#### 1.5.6 设置默认地址
- **接口地址**: `PUT /miniapp/address/default/{id}`
- **接口描述**: 设置默认收货地址
- **路径参数**:
  | 参数名 | 类型 | 必填 | 说明 |
  |--------|------|------|------|
  | id | Long | 是 | 地址ID |

---

## 2. 管理端接口

### 2.1 商品管理接口

#### 2.1.1 获取商品列表
- **接口地址**: `GET /admin/product/list`
- **接口描述**: 分页获取商品列表（支持关键字搜索）
- **请求参数**:
  | 参数名 | 类型 | 必填 | 默认值 | 说明 |
  |--------|------|------|--------|------|
  | pageNum | Integer | 否 | 1 | 页码 |
  | pageSize | Integer | 否 | 10 | 每页数量 |
  | categoryId | Long | 否 | - | 分类ID |
  | keyword | String | 否 | - | 搜索关键字 |

- **响应示例**:
```json
{
  "code": 200,
  "message": "操作成功",
  "data": {
    "total": 100,
    "records": [
      {
        "id": 1,
        "categoryId": 1,
        "name": "新鲜苹果",
        "description": "优质红富士苹果",
        "price": 12.50,
        "stock": 100,
        "image": "https://example.com/apple.jpg",
        "status": 1,
        "createTime": "2024-01-01T10:00:00",
        "updateTime": "2024-01-01T10:00:00"
      }
    ]
  }
}
```

#### 2.1.2 获取商品详情
- **接口地址**: `GET /admin/product/detail/{id}`
- **接口描述**: 根据商品ID获取商品详情
- **路径参数**:
  | 参数名 | 类型 | 必填 | 说明 |
  |--------|------|------|------|
  | id | Long | 是 | 商品ID |

#### 2.1.3 添加商品
- **接口地址**: `POST /admin/product/add`
- **接口描述**: 添加新商品
- **请求体**:
```json
{
  "categoryId": 1,
  "name": "新鲜苹果",
  "description": "优质红富士苹果",
  "price": 12.50,
  "stock": 100,
  "image": "https://example.com/apple.jpg",
  "status": 1
}
```

#### 2.1.4 更新商品
- **接口地址**: `PUT /admin/product/update`
- **接口描述**: 更新商品信息
- **请求体**:
```json
{
  "id": 1,
  "categoryId": 1,
  "name": "新鲜苹果",
  "description": "优质红富士苹果",
  "price": 15.00,
  "stock": 80,
  "image": "https://example.com/apple.jpg",
  "status": 1
}
```

#### 2.1.5 删除商品
- **接口地址**: `DELETE /admin/product/delete/{id}`
- **接口描述**: 删除商品
- **路径参数**:
  | 参数名 | 类型 | 必填 | 说明 |
  |--------|------|------|------|
  | id | Long | 是 | 商品ID |

#### 2.1.6 上架商品
- **接口地址**: `PUT /admin/product/online/{id}`
- **接口描述**: 上架商品
- **路径参数**:
  | 参数名 | 类型 | 必填 | 说明 |
  |--------|------|------|------|
  | id | Long | 是 | 商品ID |

#### 2.1.7 下架商品
- **接口地址**: `PUT /admin/product/offline/{id}`
- **接口描述**: 下架商品
- **路径参数**:
  | 参数名 | 类型 | 必填 | 说明 |
  |--------|------|------|------|
  | id | Long | 是 | 商品ID |

### 2.2 分类管理接口

#### 2.2.1 获取分类列表
- **接口地址**: `GET /admin/category/list`
- **接口描述**: 分页获取分类列表
- **请求参数**:
  | 参数名 | 类型 | 必填 | 默认值 | 说明 |
  |--------|------|------|--------|------|
  | pageNum | Integer | 否 | 1 | 页码 |
  | pageSize | Integer | 否 | 10 | 每页数量 |
  | keyword | String | 否 | - | 搜索关键字 |

#### 2.2.2 获取分类详情
- **接口地址**: `GET /admin/category/detail/{id}`
- **接口描述**: 根据分类ID获取分类详情
- **路径参数**:
  | 参数名 | 类型 | 必填 | 说明 |
  |--------|------|------|------|
  | id | Long | 是 | 分类ID |

#### 2.2.3 添加分类
- **接口地址**: `POST /admin/category/add`
- **接口描述**: 添加新分类
- **请求体**:
```json
{
  "name": "蔬菜",
  "description": "新鲜蔬菜",
  "image": "https://example.com/vegetable.jpg",
  "sort": 2,
  "status": 1
}
```

#### 2.2.4 更新分类
- **接口地址**: `PUT /admin/category/update`
- **接口描述**: 更新分类信息
- **请求体**:
```json
{
  "id": 1,
  "name": "水果",
  "description": "新鲜水果",
  "image": "https://example.com/fruit.jpg",
  "sort": 1,
  "status": 1
}
```

#### 2.2.5 删除分类
- **接口地址**: `DELETE /admin/category/delete/{id}`
- **接口描述**: 删除分类
- **路径参数**:
  | 参数名 | 类型 | 必填 | 说明 |
  |--------|------|------|------|
  | id | Long | 是 | 分类ID |

### 2.3 用户管理接口

#### 2.3.1 获取用户列表
- **接口地址**: `GET /admin/user/list`
- **接口描述**: 分页获取用户列表
- **请求参数**:
  | 参数名 | 类型 | 必填 | 默认值 | 说明 |
  |--------|------|------|--------|------|
  | pageNum | Integer | 否 | 1 | 页码 |
  | pageSize | Integer | 否 | 10 | 每页数量 |
  | keyword | String | 否 | - | 搜索关键字 |

#### 2.3.2 获取用户详情
- **接口地址**: `GET /admin/user/detail/{id}`
- **接口描述**: 根据用户ID获取用户详情
- **路径参数**:
  | 参数名 | 类型 | 必填 | 说明 |
  |--------|------|------|------|
  | id | Long | 是 | 用户ID |

#### 2.3.3 更新用户信息
- **接口地址**: `PUT /admin/user/update`
- **接口描述**: 更新用户信息
- **请求体**:
```json
{
  "id": 1,
  "username": "张三",
  "phone": "13800138000",
  "avatar": "https://example.com/avatar.jpg",
  "status": 1
}
```

#### 2.3.4 删除用户
- **接口地址**: `DELETE /admin/user/delete/{id}`
- **接口描述**: 删除用户
- **路径参数**:
  | 参数名 | 类型 | 必填 | 说明 |
  |--------|------|------|------|
  | id | Long | 是 | 用户ID |

---

## 3. 配送端接口

### 3.1 配送员管理接口

#### 3.1.1 获取配送员列表
- **接口地址**: `GET /delivery/deliveryman/list`
- **接口描述**: 分页获取配送员列表
- **请求参数**:
  | 参数名 | 类型 | 必填 | 默认值 | 说明 |
  |--------|------|------|--------|------|
  | pageNum | Integer | 否 | 1 | 页码 |
  | pageSize | Integer | 否 | 10 | 每页数量 |
  | keyword | String | 否 | - | 搜索关键字 |

#### 3.1.2 获取配送员详情
- **接口地址**: `GET /delivery/deliveryman/detail/{id}`
- **接口描述**: 根据配送员ID获取配送员详情
- **路径参数**:
  | 参数名 | 类型 | 必填 | 说明 |
  |--------|------|------|------|
  | id | Long | 是 | 配送员ID |

#### 3.1.3 添加配送员
- **接口地址**: `POST /delivery/deliveryman/add`
- **接口描述**: 添加新配送员
- **请求体**:
```json
{
  "name": "王五",
  "phone": "13800138002",
  "idCard": "110101199001011234",
  "area": "朝阳区",
  "status": 1
}
```

#### 3.1.4 更新配送员信息
- **接口地址**: `PUT /delivery/deliveryman/update`
- **接口描述**: 更新配送员信息
- **请求体**:
```json
{
  "id": 1,
  "name": "王五",
  "phone": "13800138002",
  "idCard": "110101199001011234",
  "area": "朝阳区",
  "status": 1
}
```

#### 3.1.5 删除配送员
- **接口地址**: `DELETE /delivery/deliveryman/delete/{id}`
- **接口描述**: 删除配送员
- **路径参数**:
  | 参数名 | 类型 | 必填 | 说明 |
  |--------|------|------|------|
  | id | Long | 是 | 配送员ID |

### 3.2 配送订单接口

#### 3.2.1 获取订单详情
- **接口地址**: `GET /delivery/order/detail/{id}`
- **接口描述**: 根据订单ID获取订单详情
- **路径参数**:
  | 参数名 | 类型 | 必填 | 说明 |
  |--------|------|------|------|
  | id | Long | 是 | 订单ID |

#### 3.2.2 配送订单
- **接口地址**: `PUT /delivery/order/deliver/{id}`
- **接口描述**: 标记订单为配送中
- **路径参数**:
  | 参数名 | 类型 | 必填 | 说明 |
  |--------|------|------|------|
  | id | Long | 是 | 订单ID |

---

## 4. 通用响应格式

### 4.1 成功响应
```json
{
  "code": 200,
  "message": "操作成功",
  "data": {}
}
```

### 4.2 失败响应
```json
{
  "code": 400,
  "message": "参数错误",
  "data": null
}
```

### 4.3 分页响应
```json
{
  "code": 200,
  "message": "操作成功",
  "data": {
    "total": 100,
    "records": []
  }
}
```

---

## 5. 错误码说明

| 错误码 | 说明 |
|--------|------|
| 200 | 操作成功 |
| 400 | 参数错误 |
| 401 | 未授权 |
| 403 | 禁止访问 |
| 404 | 资源不存在 |
| 500 | 服务器内部错误 |

---

## 6. 订单状态说明

| 状态码 | 状态名称 | 说明 |
|--------|----------|------|
| 0 | 待支付 | 订单已创建，等待支付 |
| 1 | 待配送 | 订单已支付，等待配送 |
| 2 | 配送中 | 订单正在配送 |
| 3 | 待评价 | 订单已送达，等待用户确认收货 |
| 4 | 已完成 | 订单已完成 |
| 5 | 已取消 | 订单已取消 |

---

## 7. 商品状态说明

| 状态码 | 状态名称 | 说明 |
|--------|----------|------|
| 0 | 下架 | 商品已下架，不可购买 |
| 1 | 上架 | 商品已上架，可以购买 |

---

## 8. 用户状态说明

| 状态码 | 状态名称 | 说明 |
|--------|----------|------|
| 0 | 禁用 | 用户被禁用，无法登录 |
| 1 | 正常 | 用户状态正常 |

---

## 9. 配送员状态说明

| 状态码 | 状态名称 | 说明 |
|--------|----------|------|
| 0 | 离线 | 配送员离线，不接单 |
| 1 | 在线 | 配送员在线，可以接单 |
| 2 | 忙碌 | 配送员忙碌，暂时不接单 |

---

## 10. 注意事项

1. 所有时间字段均为ISO 8601格式：`YYYY-MM-DDTHH:mm:ss`
2. 所有金额字段均为BigDecimal类型，保留两位小数
3. 分页查询的页码从1开始
4. 所有接口都需要进行身份验证（除了公开接口）
5. 请求头需要包含`Content-Type: application/json`
6. 响应编码为UTF-8

---

## 11. 更新日志

- **v1.0.0** (2024-01-01): 初始版本，包含基础的商品、订单、用户管理功能
- **v1.1.0** (2024-01-15): 新增购物车功能和地址管理功能
- **v1.2.0** (2024-02-01): 新增配送员管理和配送订单功能